---
title: "Ejercicios_Claude"
author: "Lucas"
date: "2026-01-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(haven)
library(tidyverse)
hogares <- read_dta("hog_jal.dta")
viviendas <- read_dta("viv_jal.dta")
personas <- read_dta("per_jal.dta")
trabajos <- read_dta("trab_jal.dta")
ingresos <- read_dta("ing_jal.dta")

```


# ===================================================================
# BLOQUE 1: FILTROS Y AGREGACIONES BÁSICAS (Calentamiento)
# ===================================================================

# Ejercicio 1.1: Promedio de gasto en alimentos
# Calcula el promedio de gasto en alimentos de todos los hogares.
# Pista: usa summarise() y mean()

```{r}
hogares %>% 
  summarise(media_gasto =  mean(gasto_mon, na.rm = TRUE))
```

# Ejercicio 1.2: Hogares con alto gasto en salud
# Filtra los hogares que gastan más de 5000 en salud.
# ¿Cuántos hogares son?
# Pista: usa filter() y nrow() o count()

```{r}
hogares %>%
  filter(salud > 500) %>%
  nrow()

```
# Ejercicio 1.3: Distribución por sexo
# Cuenta cuántas personas hay de cada sexo (1=Hombre, 2=Mujer).

```{r}
personas %>% count(sexo)

#alternativa: personas %>% 
  #group_by(sexo) %>% 
  #summarise(n = n())
```

# BLOQUE 2: JOINS SIMPLES (Relacionando tablas)
# Ejercicio 2.1: Hogares con sus viviendas
# Une la tabla de hogares con viviendas para ver el tipo de vivienda
# de cada hogar.
```{r}
hog_viv <- left_join(hogares, viviendas, by= "folioviv")
```

# Ejercicio 2.2: Personas en hogares de clase específica
# Obtén todas las personas que viven en hogares de clase_hog = 1.

```{r}
hog1 <- personas %>% semi_join(hogares %>% filter(clase_hog==1), by="folioviv", "foliohog")
nrow(hog1)
head(hog1)

hog1_1 <- inner_join(personas, hogares, by= "folioviv", "foliohog") %>%
  filter(clase_hog==1)
nrow(hog1_1)
head(hog1_1)

```

# Ejercicio 2.3: Hogares sin vivienda registrada
# Encuentra hogares que NO tienen registro en la tabla viviendas.
```{r}

hog2 <- anti_join(hogares, viviendas, by="folioviv")

```
# ===================================================================
# BLOQUE 3: AGREGACIONES CON GROUP_BY (Nivel medio)
# ===================================================================

# Ejercicio 3.1: Gasto promedio por ubicación geográfica
# Calcula el gasto monetario promedio (gasto_mon) por ubica_geo.
# Ordena de mayor a menor gasto.

```{r}
hogares%>% 
  group_by(ubica_geo) %>%
  summarise(gasto_geo = mean(gasto_mon, na.rm = TRUE )) %>%arrange(gasto_geo)
```
# Ejercicio 3.3: Ingresos totales por hogar
# Suma todos los ingresos (ing_tri) de cada hogar.
```{r}
ingresos %>% group_by(folioviv, foliohog) %>% summarise(total = sum(ing_tri, na.rm = TRUE) )
```

# Ejercicio 3.4: Porcentaje de analfabetismo por ubicación
# Calcula qué porcentaje de personas NO sabe leer/escribir (alfabetism=2)
# en cada ubica_geo.

```{r}


hog3 <- personas %>% 
  inner_join(hogares, by=c("folioviv", "foliohog")) %>%
  group_by(ubica_geo) %>%
  summarise(mean(alfabetism==2)*100)

```

# ===================================================================
# BLOQUE 4: FILTROS COMPLEJOS CON ALL/ANY (Desafiante)
# ===================================================================

# Ejercicio 4.1: Hogares donde TODOS tienen educación
# Encuentra hogares donde todas las personas asisten a la escuela 
# (asis_esc = 1) o son mayores de 18 años.

```{r}
personas%>% group_by(folioviv, foliohog)%>%
  summarise(todos_cumplen= all(asis_esc==1 | edad>18, na.rm = TRUE)) %>%
  filter(todos_cumplen)
```
# Ejercicio 4.2: Hogares con AL MENOS un trabajador
# Identifica hogares donde al menos una persona tiene trabajo registrado
# en la tabla trabajos.

```{r}
hogares%>% distinct(folioviv, foliohog)%>% 
  nrow()
personas%>% distinct(folioviv, foliohog)%>%
  nrow()

trabajos %>% distinct(folioviv, foliohog) %>% nrow()
hogares %>%semi_join(trabajos, by="folioviv", "foliohog")

```

```{r}
hogares %>%
  semi_join(trabajos, by = c("folioviv", "foliohog"))
```

# Ejercicio 4.3: Hogares donde NADIE habla lengua indígena
# Encuentra hogares donde ninguna persona habla lengua indígena 
# (hablaind = 2 significa NO habla).

```{r}
hogares%>% 
  semi_join(personas %>% filter(hablaind==2), by=c("folioviv", "foliohog" ))
#El filter es por fila, aca le digo que me filtre los hogares donde al menos una persona no es hablante indigena

hogares %>% 
  semi_join(personas%>% 
  group_by(folioviv, foliohog)%>%
  summarise(nadie_habla= all(hablaind==2, na.rm = TRUE)) %>%
  filter(nadie_habla), by=c("folioviv","foliohog")
  )
#Aca le digo que me filtre los hogares en donde ninguna personas habla lengua indigena
```

# BLOQUE 4.5: EJERCICIOS ADICIONALES - PRÁCTICA INTENSIVA
# (Mismo nivel que Bloque 4, más variedad)
# ===================================================================

# Ejercicio 4.5.1: Hogares sin menores de edad
# Encuentra hogares donde TODAS las personas son mayores de 18 años.

```{r}
personas  %>%  group_by(folioviv, foliohog) %>% 
  summarise(mayores_18 = all(edad >= 18, na.rm=TRUE), .groups = "drop") %>% 
  filter(mayores_18) %>% 
  nrow()

```
# Ejercicio 4.5.2: Hogares con diversidad de edades
# Encuentra hogares que tengan AL MENOS una persona menor de 18 Y
# AL MENOS una persona mayor de 60.

```{r}
personas  %>%  group_by(folioviv, foliohog) %>% 
  summarise(franja = any(edad < 18, na.rm=TRUE) & any(edad > 60, na.rm=TRUE), .groups = "drop") %>% 
  filter(franja) %>% 
  nrow()

```
#Diferencia clave:
#edad < 18 & edad > 60 (AND dentro)
#Evalúa cada persona individualmente:

#Persona 1: ¿Es menor de 18 Y mayor de 60? → Imposible → FALSE
#Persona 2: ¿Es menor de 18 Y mayor de 60? → Imposible → FALSE

#any(edad < 18) & any(edad > 60) (AND fuera)
#Evalúa el grupo completo:

#¿Hay AL MENOS una persona < 18? → TRUE
#¿Hay AL MENOS una persona > 60? → TRUE
#Ambas TRUE → TRUE


# Ejercicio 4.5.3: Hogares completamente alfabetizados con niños
# Encuentra hogares donde:
# - TODAS las personas son alfabetizadas (alfabetism == 1)
# - Y tienen AL MENOS un menor de 12 años

```{r}
personas  %>%  group_by(folioviv, foliohog) %>% 
  summarise(alf = all(alfabetism==1 , na.rm=TRUE) & any(edad < 12, na.rm=TRUE), .groups = "drop") %>% 
  filter(alf) %>% 
  nrow()
```
# Ejercicio 4.5.4: Hogares sin ingresos registrados
# Encuentra hogares que NO tienen ningún registro en la tabla ingresos.

```{r}
hogares %>% anti_join(ingresos, by=c("folioviv", "foliohog"))

```

# Ejercicio 4.5.5: Hogares donde nadie trabaja
# Encuentra hogares que NO tienen ninguna persona registrada en trabajos.
# ¿Cuántos hogares son? ¿Cuál es su gasto promedio?


```{r}
hogares %>% anti_join(trabajos, by=c("folioviv", "foliohog")) %>%
  summarise(hogares_sin_trabajo = n(), 
            gasto_mediomean = mean(gasto_mon))

```

# Ejercicio 4.5.6: Hogares multigeneracionales
# Encuentra hogares con AL MENOS 3 generaciones:
# - Al menos una persona < 18 años (niños)
# - Al menos una persona entre 18-59 años (adultos)
# - Al menos una persona >= 60 años (adultos mayores)


```{r}
personas  %>%  group_by(folioviv, foliohog) %>% 
  summarise(generaciones = any (edad<18 , na.rm=TRUE) & any(edad > 18 & edad<59, na.rm=TRUE) & any(edad>= 60), .groups = "drop") %>% 
  filter(generaciones) %>% 
  nrow()
```
#version mas copada


```{r}
personas  %>%  group_by(folioviv, foliohog) %>% 
  summarise(niños = any (edad<18 , na.rm=TRUE), 
            adultos = any(edad > 18 & edad<59, na.rm=TRUE),
            mayores= any(edad>= 60, na.rm=TRUE), .groups = "drop") %>%
  summarise(hogares_niños=sum(niños),
            hogares_adultos=sum(adultos),
            hograes_mayores=sum(mayores))
  
```

```{r}
personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(
    niños = any(edad < 18, na.rm = TRUE),
    adultos = any(edad >= 18 & edad < 60, na.rm = TRUE),
    mayores = any(edad >= 60, na.rm = TRUE),
    .groups = "drop"
  ) %>% 
  count(niños, adultos, mayores)
```


```{r}
# Para tu análisis (guardalo)
analisis_detallado <- personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(...) %>%
  count(tiene_ninos, tiene_adultos, tiene_mayores)

# Para el reporte final
reporte_ejecutivo <- analisis_detallado %>%
  summarise(
    hogares_con_ninos = sum(tiene_ninos),
    hogares_con_adultos = sum(tiene_adultos),
    ...
  )
```

# Ejercicio 4.5.7: Hogares homogéneos por sexo
# Encuentra hogares donde TODAS las personas son del mismo sexo.


```{r}
personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(
    monosexual = n_distinct(sexo) == 1,
    .groups = "drop"
  ) %>% 
  filter(monosexual) %>%
  nrow()
```
#No le pide que tome las filas con sexo 1, sino le dice que cuente los hogares cuyas filas son todas de un mismo valor


```{r}
personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(
    monosexual = n_distinct(sexo) == 1,
    cantidad_sexos = n_distinct(sexo),
    .groups = "drop"
  ) %>% 
  count(monosexual, cantidad_sexos)
```




```{r}
personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(
    todos_hombres = all(sexo == 1, na.rm = TRUE),
    todas_mujeres = all(sexo == 2, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  summarise(
    hogares_solo_hombres = sum(todos_hombres),
    hogares_solo_mujeres = sum(todas_mujeres),
    total_homogeneos = sum(todos_hombres | todas_mujeres)
  )
```


# Ejercicio 4.5.8: Hogares con alta asistencia escolar
# Encuentra hogares donde TODAS las personas menores de 18 años
# asisten a la escuela (asis_esc == 1).

```{r}
personas %>% 
  group_by(folioviv, foliohog) %>%  
  summarise(alfabetizados = all(edad< 18 & asis_esc==1), .groups = "drop")# pregunta si todos en el hogar son menores de 18 y van a la escuela, no si todos los menores de 18 van a las escuela

personas %>% filter(edad < 18) %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(alfabetizados = all(asis_esc ==1, na.rm = TRUE),
            tiene_menores = n() > 0,  # Verificar que haya al menos un menor
            .groups = "drop"
            ) %>% 
  filter(alfabetizados, tiene_menores)


#Recordar que sin la verificacion incluye hogares sin menores (porque all() sobre un conjunto vacío devuelve TRUE)
```

# Ejercicio 4.5.9: Hogares vulnerables por discapacidad
# Encuentra hogares donde AL MENOS DOS personas tienen discapacidad
# (disc1 != "6", donde "6" significa sin discapacidad).

```{r}
personas %>% 
  group_by(folioviv, foliohog) %>% 
  summarise(
    cant_con_disc = sum(disc1 != "6", na.rm = TRUE),
    .groups = "drop"
  ) %>% 
  filter(cant_con_disc >= 2)

#alternativa
personas %>% 
  filter(disc1 != "6") %>%  # Solo personas con discapacidad
  group_by(folioviv, foliohog) %>% 
  summarise(cant_con_disc = n(), .groups = "drop") %>%  # Contar
  filter(cant_con_disc >= 2)  # Al menos 2


#alternativa 2
personas %>% 
  filter(disc1 != "6") %>%
  group_by(folioviv, foliohog) %>% 
  summarise(cant_con_disc = n(), .groups = "drop") %>%
  filter(cant_con_disc >= 2) %>%
  nrow()

```

# Ejercicio 4.5.10: Hogares con ingresos pero sin trabajos
# Encuentra hogares que tienen registros en ingresos pero NO en trabajos.
# ¿Cómo puede ser esto? (pensá: jubilaciones, ayudas, etc.)

```{r}

ingresos %>%  
  anti_join(trabajos, by=c("folioviv", "foliohog")) %>% 
  distinct (folioviv, foliohog) %>% 
  nrow()


#alternativa
hogares %>%
  semi_join(ingresos, by = c("folioviv", "foliohog")) %>%
  anti_join(trabajos, by = c("folioviv", "foliohog"))

#Ventaja: La tabla hogares ya tiene una sola fila por hogar, así que no necesitás distinct().

```

# Ejercicio 4.5.11: Hogares equilibrados en gasto
# Encuentra hogares donde el gasto en alimentos NO supera el 40%
# del gasto total Y el gasto en salud es mayor a 0.

```{r}
per <- hogares %>% 
  filter(gasto_mon > 0, salud > 0) %>%  # Filtrar antes de dividir
  mutate(percent_alimentos = round((alimentos / gasto_mon) * 100, 2)) %>% 
  filter(percent_alimentos <= 40)

#extra para cambiar la label
per$percent_alimentos <- haven::labelled(
  per$percent_alimentos,
  label = "% de gasto en alimentos"
)
```

# Ejercicio 4.5.12: Personas en hogares sin electricidad
# ¿Cuántas personas viven en viviendas sin electricidad (disp_elect != 1)?

```{r}
personas %>% 
  left_join(viviendas, by = "folioviv") %>%
  filter(disp_elect != 1) %>%
  count()

#alternativa
  personas %>% 
  left_join(viviendas, by = "folioviv") %>%
  filter(disp_elect != 1) %>%
  summarise(
    cantidad_personas = n(),
    cantidad_hogares = n_distinct(folioviv, foliohog),
    cantidad_viviendas = n_distinct(folioviv)
  )

```

# Ejercicio 4.5.13: Hogares pequeños con altos ingresos
# Encuentra hogares con 2 o menos personas Y con ing_cor > 50000.
# ¿Cuántos son? ¿Cuál es su gasto promedio en educación?

```{r}
# count() - más conciso
personas %>% count(folioviv, foliohog)

# group_by + summarise - más explícito
personas %>% group_by(folioviv, foliohog) %>%
  summarise(cant_personas = n(), .groups = "drop") %>%
  filter(cant_personas<=2) %>% 
  inner_join(hogares, by=c("folioviv", "foliohog")) %>%
  filter(ing_cor>50000) %>%
  summarise(media_educ= round(mean(educa_espa, na.rm = TRUE),2),
              cantidad_de_hogares = n())
```

# Ejercicio 4.5.14: Hogares donde NADIE tiene trabajo formal
# Encuentra hogares que tienen personas registradas en trabajos
# pero NINGÚN trabajo tiene prestaciones (pres_2, pres_3, pres_4 todos en 0 o NA)

```{r}

trabajos %>% 
  group_by(folioviv, foliohog) %>%
  summarise(
    todos_sin_prestaciones = all((pres_2 == 0 | is.na(pres_2)) & 
                                  (pres_3 == 0 | is.na(pres_3)) & 
                                  (pres_4 == 0 | is.na(pres_4))),
    .groups = "drop"
  ) %>%
  filter(todos_sin_prestaciones)

#probar alterna
hogares %>%
  semi_join(trabajos %>% 
  group_by(folioviv, foliohog) %>%
  summarise(
    todos_sin_prestaciones = all((pres_2 == 0 | is.na(pres_2)) & 
                                  (pres_3 == 0 | is.na(pres_3)) & 
                                  (pres_4 == 0 | is.na(pres_4))),
    .groups = "drop"
  ) %>%
  filter(todos_sin_prestaciones), by = c("folioviv", "foliohog")
  )

```

#Ejercicio 4.5.15: Comparación de hogares con/sin niños
#Crea dos grupos: hogares con menores de 18 y hogares sin menores
#Compara el gasto promedio en educación de cada grupo

```{r}
personas %>% group_by(folioviv, foliohog) %>% 
  summarise(grupo_et = any (edad<18), .groups = "drop")%>%
  inner_join(hogares %>% 
               select(folioviv, foliohog, educa_espa), by= c("folioviv", "foliohog")) %>%
  mutate(menores = ifelse (grupo_et, "con menores", "sin menores")) %>%
  group_by(menores) %>% 
  summarise(gasto_promedio_educ = mean(educa_espa, na.rm = TRUE))

```

# ===================================================================
# BLOQUE 4.6: EJERCICIOS DE FLUJO LÓGICO (Práctica adicional)
# Mismo nivel que 4.5.15 - Enfoque en pensar el flujo correcto
# ===================================================================

# Ejercicio 4.6.1: Comparación hogares urbanos vs rurales
# Clasifica hogares según ubica_geo (los primeros 2 dígitos indican el estado).
# Crea dos grupos: urbano (ubica_geo que termina en número impar) 
# vs rural (termina en par).
# Compara el ingreso promedio (ing_cor) de cada grupo.

```{r}
hogares %>% 
  mutate(espacio = ifelse(as.numeric(ubica_geo) %% 2==0, "rural", "urbano")) %>% 
  group_by(espacio) %>% 
  summarise(media_ing= mean(ing_cor, na.rm = TRUE))

```

# Ejercicio 4.6.2: Hogares con balance generacional
# Clasifica hogares en tres categorías:
# - "Principalmente niños": >50% de personas menores de 18
# - "Principalmente adultos": >50% de personas entre 18-59
# - "Principalmente mayores": >50% de personas ≥60
# - "Mixto": ningún grupo supera el 50%
# ¿Cuántos hogares hay de cada tipo? ¿Cuál es el gasto promedio en salud?

```{r}
personas %>% 
  group_by(folioviv, foliohog) %>%
  summarise(
    total=n(),
    nenes = sum(edad < 18) / total *100, 
            adultos = sum(edad>=18 & edad<60) /total*100,
            mayores= sum(edad >= 60)/total*100, .groups = "drop"
    ) %>%  
  mutate(franja_et= case_when(
    nenes>50~"Principalmente niños",
    adultos>50~ "Principalmente adultos",
    mayores>50~"Principalmente ancianos",
    TRUE~"Mixto"
    ))%>% 
  inner_join(hogares, by=c("folioviv", "foliohog")) %>% 
  group_by(franja_et) %>% 
  summarise(
    n_hogares = n(),
    gasto_promedio = mean(salud, na.rm=TRUE)
    )
  

```

# Ejercicio 4.6.2: Hogares con balance generacional
# Clasifica hogares en tres categorías:
# - "Principalmente niños": >50% de personas menores de 18
# - "Principalmente adultos": >50% de personas entre 18-59
# - "Principalmente mayores": >50% de personas ≥60
# - "Mixto": ningún grupo supera el 50%
# ¿Cuántos hogares hay de cada tipo? ¿Cuál es el gasto promedio en salud?


```{r}
personas %>%
  group_by(folioviv, foliohog) %>%
  summarise(
    porc_ninos = (sum(edad < 18) / n()) * 100,
    porc_adultos = (sum(edad >= 18 & edad < 60) / n()) * 100,
    porc_mayores = (sum(edad >= 60) / n()) * 100,
    .groups = "drop"
  ) %>%
  mutate(categoria = case_when(
    porc_ninos > 50 ~ "Principalmente niños",
    porc_adultos > 50 ~ "Principalmente adultos",
    porc_mayores > 50 ~ "Principalmente mayores",
    TRUE ~ "Mixto"
  )) %>%
  count(categoria)  # ← Agrupa y cuenta automáticamente

```

# Ejercicio 4.6.3: Intensidad laboral del hogar
# Para cada hogar, calcula la "tasa de empleo":
# (personas con trabajo / personas en edad laboral 18-65) * 100
# Clasifica hogares en:
# - "Alta empleabilidad": tasa ≥ 75%
# - "Media empleabilidad": tasa entre 25-74%
# - "Baja empleabilidad": tasa < 25%
# - "Sin población laboral": no hay personas 18-65
# Compara el ingreso promedio de cada grupo.
#Alternativa 1
```{r}
personas %>%  # PASO 1: Definir el UNIVERSO (personas en edad laboral)
  filter(edad >= 18 & edad <= 65) %>% 

  # PASO 2: Marcar quiénes están EMPLEADAS dentro de ese universo 
  mutate( clave = paste(folioviv, foliohog, numren, sep = "-"), empleado = clave %in% paste(trabajos$folioviv, trabajos$foliohog, trabajos$numren, sep = "-") ) %>% 

  # PASO 3: Agrupar por hogar 
  group_by(folioviv, foliohog) %>% summarise( universo_laboral = n(),empleados = sum(empleado), .groups = "drop" )%>% # Numerador: empleados dentro del universo 

  # PASO 4: Calcular el indicador 
  mutate( tasa_empleo = (empleados / universo_laboral) * 100
  )

```

#Alternativa 2:
```{r}
personas %>%
  filter(edad >= 18 & edad <= 65) %>%
  left_join(
    trabajos %>%
      select(folioviv, foliohog, numren) %>%
      mutate(empleado = TRUE),
    by = c("folioviv", "foliohog", "numren")
  ) %>%
  mutate(
    empleado = replace_na(empleado, FALSE)
  ) %>%
  group_by(folioviv, foliohog) %>%
  summarise(
    universo_laboral = n(),
    empleados = sum(empleado),
    .groups = "drop"
  ) %>%
  mutate(
    tasa_empleo = (empleados / universo_laboral) * 100
  )

```

#Alternativa 3: mas adecuada para medir pobreza estructural
```{r}
personas %>%
  mutate(
    empleable = edad >= 18 & edad <= 65
  ) %>%
  left_join(
    trabajos %>%
      select(folioviv, foliohog, numren) %>%
      mutate(empleado = TRUE),
    by = c("folioviv", "foliohog", "numren")
  ) %>%
  mutate(
    empleado = replace_na(empleado, FALSE)
  ) %>%
  group_by(folioviv, foliohog) %>%
  summarise(
    universo_laboral = sum(empleable),
    empleados = sum(empleado & empleable),
    .groups = "drop"
  ) %>%
  mutate(
    tasa_empleo = if_else(
      universo_laboral == 0,
      NA_real_,
      (empleados / universo_laboral) * 100
    )
  )

```

#Altenrativa distinct
```{r}
empleados <- trabajos %>%
  distinct(folioviv, foliohog, numren) %>%
  mutate(tiene_trabajo = TRUE)
personas_marcadas <- personas %>%
  left_join(empleados, by = c("folioviv", "foliohog", "numren"))
mutate(tiene_trabajo = replace_na(tiene_trabajo, FALSE))


hogares_empleo <- personas_marcadas %>%
  group_by(folioviv, foliohog) %>%
  summarise(
    total_personas = n(),
    edad_laboral = sum(edad >= 18 & edad <= 65, na.rm = TRUE),
    con_trabajo = sum(tiene_trabajo == TRUE & edad >= 18 & edad <= 65, na.rm = TRUE),
    .groups = "drop"
  )

#Alternativa 2
hogares_empleo <- hogares_empleo %>%
  mutate(
    tasa_empleo = case_when(
      edad_laboral == 0 ~ NA_real_,  # Sin población laboral
      TRUE ~ (con_trabajo / edad_laboral) * 100
    )
  )

hogares_clasificados <- hogares_empleo %>%
  mutate(
    categoria = case_when(
      edad_laboral == 0 ~ "Sin población laboral",
      tasa_empleo >= 75 ~ "Alta empleabilidad",
      tasa_empleo >= 25 ~ "Media empleabilidad",
      TRUE ~ "Baja empleabilidad"
    )
  )
```

